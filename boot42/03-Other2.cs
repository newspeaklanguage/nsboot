'From nsboot-2011-08-18 of 18 August 2011 [latest update: #10966] on 9 October 2011 at 10:02:11 am'!!SmalltalkImage methodsFor: 'housekeeping' stamp: 'ryan 10/9/2011 10:01'!condenseChanges	"Move all the changes onto a compacted sources file."	"Smalltalk condenseChanges"	| f oldChanges count |	f := FileStream fileNamed: 'ST80.temp'.	f header; timeStamp.		'Condensing Changes File...'		displayProgressAt: Sensor cursorPoint		from: 0		to: self classNames size		during: [:bar | 			count := 0.			self				allClassesDo: [:cls | 					bar value: (count := count + 1).					self copySourcesOf: cls into: f.].						Smalltalk values do: [:cls |				(cls language isNewspeakLanguage3)				ifTrue: [self copySourcesOf: cls mixin into: f]].								].	SmalltalkImage current lastQuitLogPosition: f position.	f trailer; close.	oldChanges := SourceFiles at: 2.	oldChanges close.	FileDirectory default deleteFileNamed: oldChanges name , '.old';		 rename: oldChanges name toBe: oldChanges name , '.old';		 rename: f name toBe: oldChanges name.	self setMacFileInfoOn: oldChanges name.	SourceFiles		at: 2		put: (StandardFileStream oldFileNamed: oldChanges name)! !!SmalltalkImage methodsFor: 'housekeeping' stamp: 'ryan 10/9/2011 10:02'!copySourcesOf: cls into: f	cls moveChangesTo: f.	cls putClassCommentToCondensedChangesFile: f. 	cls classSide moveChangesTo: f.		([cls isMixin] ifError: [false]) ifTrue: [		cls nestedClasses do: [:inner | self copySourcesOf: inner into: f].	] ifFalse: [	cls language isNewspeakLanguage3 ifTrue: [		(DefiningClassMetadata of: cls) nestedClasses			do: [:inner | self copySourcesOf: inner into: f]].	]! !