'From nsboot-2013-01-08 of 8 January 2013 [latest update: #11860] on 8 January 2013 at 6:47:58 pm'!Object subclass: #NewspeakBootstrap	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'NewspeakBootstrap'!"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!NewspeakBootstrap class	instanceVariableNames: ''!!NewspeakBootstrap class methodsFor: 'as yet unclassified' stamp: 'Unknown 3/21/2013 09:35'!boot	"Force a save to avoid dialog about incompatibility of JIT-saved images with pre-JIT VMs."	Smalltalk snapshot: true andQuit: false embedded: false.	Utilities setAuthorInitials: 'bootstrapping'.	"This first change helps (filehandlelimits) supress issues with running 	 out of file-handles.  This can happen if your limit is	 low (1024) and 	 Monticello is examing overrides on packages, where it will make a 	 copy of the source file streams for each method."	self loadChangeset: 'filehandlelimits.1.cs'.	self loadChangeset: '01-LimitedUnload.cs'.	self loadChangeset: '02-LimitedUnload.cs'.	self loadChangeset: '03-Other.cs'.	self loadChangeset: '03-Other2.cs'.	self loadChangeset: '03-Other3.cs'.	self loadChangeset: '04-SetupPreferences.cs'.	"self loadPackage: 'NsSvnRepository-ryan.24.mcz'."	self loadPackage: 'NsMultilanguage-ryan.77.mcz'.	self loadPackage: 'NewsqueakBase-eem.95.mcz'.	self loadPackage: 'NsSystem-eliot.57.mcz'.	self loadPackage: 'XML-Parser-ryan.9.mcz'.	self loadChangeset: '13-RecreateSpecialObjectsArray.st'.	self loadPackage: 'FFI-Kernel-ryan.9.mcz'.	self loadPackage: 'OSProcess-ryan.11.mcz'.	self loadPackage: 'Shout-bwesterg.75.mcz'.	self loadChangeset: '20-PackagingCore.st'.	self loadPackage: 'NewspeakFacelift-ryan.8.mcz'.	self loadChangeset: '26-BaseEnhancements.st'.	self loadChangeset: '27-SHTextStylerST80 setupForNewsqueak.st'.	self loadPackage: 'Yield-ryan.11.mcz'.	self loadPackage: 'NewspeakCore-ryan.69.mcz'.	"self loadPackage: 'Newsqueak-conversions-ryan.19.mcz'."	self loadPackage: 'Newsqueak-mixins-ryan.105.mcz'.	self loadPackage: 'NsFFI-eliot.34.mcz'.	self loadPackage: 'Newspeak-ryan.257.mcz'.	self loadPackage: 'NOFBootstrap-ryan.23.mcz'.	self loadChangeset: '40-NewspeakBytecode.cs'.	self loadPackage: 'INIFile-Core-ryan.2.mcz'.	self loadPackage: 'BrazilForMorphic-vassili.33.mcz'.	self loadPackage: 'Brazil-ryan.323.mcz'.	self loadPackage: 'ExternalProcess-bwesterg.27.mcz'.	"Supress monticello load warnings for the Network package. 	 It has been maked dirty as a side-effect of changesets above.	 This particular version has the version of UUID class>>#String:	 that we need."	[self loadPackage: 'Network-bwesterg.141.mcz'] on: Warning do: [:ex | ex resume].	self loadPackage: 'Hopscotch-ryan.275.mcz'.	self loadPackage: 'NativeSession-eliot.99.mcz'.	"self loadPackage: 'NewspeakObjectFormat-ryan.37.mcz'."	self loadPackage: 'NewspeakSynchronization-ryan.47.mcz'.	self loadPackage: 'NSCollections-ryan.55.mcz'.	self loadPackage: 'NSFiles-ryan.30.mcz'.	"self loadPackage: 'NsSvnRepository2-ryan.42.mcz'."	self loadPackage: 'NsToolSet-ryan.46.mcz'.	"self loadPackage: 'SourceManagement-cadence.199.mcz'."	self loadPackage: 'VmMirror-ryan.33.mcz'.	self loadPackage: 'Win32API-ryan.46.mcz'.		self loadChangeset: '95-PostPatches.cs'.		(MCWorkingCopy allManagers select:		[:wc | #('Compiler*' 'Kernel*' 'System*') anySatisfy: 			[:pat| pat match: wc package name]]) 				do: [:wc| wc modified: false].	self loadPackage: 'System-eliot.472.mcz'.	self loadPackage: 'Compiler.newspeak-eliot.224.mcz'.	self loadPackage: 'Kernel.newspeak-eliot.675.mcz'.	"Now throw the switch to compile with the new set"	self loadPackage: 'Compiler.newspeak-eliot.229.mcz'.		self loadNewspeakModules.	self loadChangeset: '46-SetupAndQuit.st'.		Utilities setAuthorInitials: ''! !!NewspeakBootstrap class methodsFor: 'as yet unclassified' stamp: 'Unknown 8/7/2012 15:16'!cr	Transcript cr.	FileStream stdout cr.! !!NewspeakBootstrap class methodsFor: 'as yet unclassified' stamp: 'Unknown 8/7/2012 14:38'!initialize	[WorldState addDeferredUIMessage: [self boot]] forkAt: 20 named: 'Bootstrapping'! !!NewspeakBootstrap class methodsFor: 'as yet unclassified' stamp: 'ryan 8/7/2012 21:50'!loadChangeset: filename	self report: 'Loading changeset ', filename during:		[ChangeSet fileIntoNewChangeSet: 			(FileDirectory default / 'smalltalk' fullNameFor: filename)].! !!NewspeakBootstrap class methodsFor: 'as yet unclassified' stamp: 'ryan 8/7/2012 21:55'!loadNewspeakModules	| runtime platform repoDir files |	runtime := NewspeakObjectFormatDeserializer appFrom: 'BootstrapRuntimeForSqueak.nof'.	platform := runtime using: VMMirror new.	BlackMarket platform: platform.		Transcript open.	repoDir := (FileDirectory default containingDirectory / 'newspeak').	files := repoDir fileNames select: [:ea | ea endsWith: '.ns3'].	files := files sortBy: [:a :b | a < b].	files do: [:ea | 		self report: 'Compiling module ', ea during:			[ | klass |			klass := LanguageFileReader new compileFile: (repoDir fullNameFor: ea).			PackageInfo named: (klass basicCategory findTokens: '-') first]].		BlackMarket resetEverything.! !!NewspeakBootstrap class methodsFor: 'as yet unclassified' stamp: 'ryan 8/7/2012 21:48'!loadPackage: filename	self report: 'Loading package ', filename during:		[ | repository |		repository := MCDirectoryRepository new			directory: (FileDirectory default / 'smalltalk').			(repository loadVersionFromFileNamed: filename) load].! !!NewspeakBootstrap class methodsFor: 'as yet unclassified' stamp: 'ryan 8/7/2012 21:58'!print: string	Transcript nextPutAll: string; flush.	FileStream stdout nextPutAll: string.! !!NewspeakBootstrap class methodsFor: 'as yet unclassified' stamp: 'ryan 8/7/2012 21:54'!report: message during: block	| time |	self cr.	self print: message.	time := block timeToRun.	self print: '. Done in ', (time / 1000) floor printString, ' seconds.'.! !NewspeakBootstrap initialize!