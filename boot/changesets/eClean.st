"
   Licensed under the Squeak License (the ''License''); you may not use this file except in compliance with the License.  You may obtain a copy of the License at  http://www.squeak.org/SqueakLicense/
"!
'From nsboot-2008-05-19.00 of 20 May 2008 [latest update: #0] on 20 May 2008 at 2:02:58 am'!!SmalltalkImage methodsFor: 'image cleanup' stamp: 'Ahe 4/23/2008 01:30'!fixObsoleteReferences	"SmalltalkImage current fixObsoleteReferences"	| informee obsoleteBindings obsName realName realClass |	Smalltalk garbageCollect; garbageCollect.	Preference allInstances do: [:each | 		informee := each instVarNamed: #changeInformee.		((informee isKindOf: Behavior)			and: [informee isObsolete])			ifTrue: [				Transcript show: 'Preference: '; show: each name; cr.				Smalltalk at: (informee name copyReplaceAll: 'AnObsolete' with: '') asSymbol ifPresent: [ :ref |					each instVarNamed: #changeInformee put: ref]]]. 	CompiledMethod allInstances do: [:method |		obsoleteBindings := method literals select: [:literal |			literal isVariableBinding				and: [literal value isBehavior]				and: [literal value isObsolete]].		obsoleteBindings do: [:binding |			obsName := binding value name.			Transcript show: 'Binding: '; show: obsName; cr.			realName := obsName copyReplaceAll: 'AnObsolete' with: ''.			realClass := Smalltalk at: realName asSymbol ifAbsent: [UndefinedObject].			binding isSpecialWriteBinding				ifTrue: [binding privateSetKey: binding key value: realClass]				ifFalse: [binding key: binding key value: realClass]]].	Behavior flushObsoleteSubclasses.	Smalltalk garbageCollect; garbageCollect.	SystemNavigation default obsoleteBehaviors size > 0		ifTrue: [			SystemNavigation default obsoleteBehaviors inspect.			self error:'Still have obsolete behaviors. See inspector'].! !Preferences resetHaloSpecifications!Object removeSelector: #openInstanceBrowserWithTiles!Object removeSelector: #isPlayerLike!Object removeSelector: #eToyStreamedRepresentationNotifying:!DeepCopier removeSelector: #mapUniClasses!SystemOrganization removeSystemCategory: 'UserObjects'!Preferences removePreference: #allowEtoyUserCustomEvents!Utilities class removeSelector: #addToTrash:!Utilities class removeSelector: #emptyScrapsBook!Utilities class removeSelector: #maybeEmptyTrash!Utilities class removeSelector: #scrapsBook!Utilities class removeSelector: #trashTitle!Utilities classPool removeKey: #ScrapsBook!Smalltalk removeClassNamed: #EventTest!Smalltalk removeClassNamed: #LocaleTest!Smalltalk removeClassNamed: #ObjectFinalizerTests!Smalltalk removeClassNamed: #StandardSystemFontsTest!Smalltalk removeClassNamed: #SystemVersionTest!Preferences removePreference: #typeCheckingInTileScripting!Preferences removePreference: #universalTiles!Preferences removePreference: #useVectorVocabulary!Preferences removePreference: #uniTilesClassic!Preferences removePreference: #simpleHalosInForce!ScriptingSystem := nil.Smalltalk removeKey: #ScriptingSystem!CustomEventsRegistry := nil.Smalltalk removeKey: #CustomEventsRegistry!